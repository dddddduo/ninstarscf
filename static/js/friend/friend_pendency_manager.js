function gpOperateFormatter(e,n,t){return['<a class="edit" href="javascript:void(0)" title="处理">','<i class="glyphicon glyphicon-edit"></i>',"</a>",'<a class="remove ml10" href="javascript:void(0)" title="删除">','<i class="glyphicon glyphicon-remove"></i>',"</a>"].join("")}function initGetPendencyTable(e){$("#get_pendency_table").bootstrapTable({method:"get",cache:!1,height:500,striped:!0,pagination:!0,pageSize:pageSize,pageNumber:1,pageList:[10,20,50,100],search:!0,showColumns:!0,clickToSelect:!0,columns:[{field:"To_Account",title:"对方账号",align:"center",valign:"middle",sortable:"true",visible:!1},{field:"Nick",title:"对方昵称",align:"center",valign:"middle",sortable:"true"},{field:"AddWording",title:"附言",align:"center",valign:"middle",sortable:"true"},{field:"AddSource",title:"来源",align:"center",valign:"middle",sortable:"true",visible:!1},{field:"AddTime",title:"申请时间",align:"center",valign:"middle",sortable:"true"},{field:"gpOperate",title:"操作",align:"center",valign:"middle",formatter:"gpOperateFormatter",events:"gpOperateEvents"}],data:e,formatNoMatches:function(){return"无符合条件的记录"}})}window.gpOperateEvents={"click .edit":function(e,n,t,o){$("#rf_to_account").val(t.To_Account),$("#response_friend_dialog").modal("show")},"click .remove":function(e,n,t,o){confirm("确定删除这条记录吗？")&&deletePendency(t.To_Account)}};var getPendency=function(e){initGetPendencyTable([]);var n={From_Account:loginInfo.identifier,PendencyType:"Pendency_Type_ComeIn",StartTime:0,MaxLimited:totalCount,LastSequence:0};webim.getPendency(n,function(n){var t=[];if(n.UnreadPendencyCount>0){for(var o in n.PendencyItem){var i=webim.Tool.formatTimeStamp(n.PendencyItem[o].AddTime),c=webim.Tool.formatText2Html(n.PendencyItem[o].Nick);""==c&&(c=n.PendencyItem[o].To_Account);var a=webim.Tool.formatText2Html(n.PendencyItem[o].AddWording);t.push({To_Account:webim.Tool.formatText2Html(n.PendencyItem[o].To_Account),Nick:c,AddWording:a,AddSource:n.PendencyItem[o].AddSource,AddTime:i})}$("#get_pendency_table").bootstrapTable("load",t),$("#get_pendency_dialog").modal("show")}else e||alert("没有加好友申请")},function(e){alert(e.ErrorInfo)})},deletePendency=function(e){var n={From_Account:loginInfo.identifier,PendencyType:"Pendency_Type_ComeIn",To_Account:[e]};webim.deletePendency(n,function(n){$("#get_pendency_table").bootstrapTable("remove",{field:"To_Account",values:[e]}),alert("删除好友申请成功")},function(e){alert(e.ErrorInfo)})},responseFriend=function(){var e=[{To_Account:$("#rf_to_account").val(),ResponseAction:$('input[name="rf_action_radio"]:checked').val()}],n={From_Account:loginInfo.identifier,ResponseFriendItem:e};webim.responseFriend(n,function(n){$("#get_pendency_table").bootstrapTable("remove",{field:"To_Account",values:[$("#rf_to_account").val()]}),$("#response_friend_dialog").modal("hide"),"Response_Action_AgreeAndAdd"==e[0].ResponseAction,alert("处理好友申请成功")},function(e){alert(e.ErrorInfo)})};